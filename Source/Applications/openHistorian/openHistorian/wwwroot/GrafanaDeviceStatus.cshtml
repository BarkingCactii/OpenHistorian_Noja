@*******************************************************************************************************
//  GrafanaDeviceStatus.cshtml - Gbtc
//
//  Copyright © 2016, Grid Protection Alliance.  All Rights Reserved.
//
//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See
//  the NOTICE file distributed with this work for additional information regarding copyright ownership.
//  The GPA licenses this file to you under the MIT License (MIT), the "License"; you may not use this
//  file except in compliance with the License. You may obtain a copy of the License at:
//
//      http://opensource.org/licenses/MIT
//
//  Unless agreed to in writing, the subject software distributed under the License is distributed on an
//  "AS-IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the
//  License for the specific language governing permissions and limitations.
//
//  Code Modification History:
//  ----------------------------------------------------------------------------------------------------
//  12/19/2017 - William Ernest
//       Generated original version of source code.
//
//*****************************************************************************************************@
@using GSF.Web.Model
@using System.Net.Http
@using GSF.Web
@using GSF.Web.Hosting
@using GSF.Web.Shared
@using openHistorian.Adapters.Model

@{
    HttpRequestMessage request = ViewBag.Request;
    Dictionary<string, string> parameters = request.QueryParameters();
    string id;
    parameters.TryGetValue("ID", out id);

    if (string.IsNullOrEmpty(id))
    {
        id = "0";
    }

    AlarmDeviceStateView view;

    using(DataContext dataContext = new DataContext("systemSettings"))
    {
        view = dataContext.Table<AlarmDeviceStateView>().QueryRecordWhere("ID = {0}", id);

    }
}

<!DOCTYPE html>
<html>
    <head>
        <title>Device Alarm</title>
        <style>
            html, body {
                height: 100%;
            }
            .btn-group{
                text-align: center;
            }
            .btn-group button {
                background-color: #4CAF50; /* Green background */
                border: 1px solid green; /* Green border */
                color: white; /* White text */
                padding: 10px 24px; /* Some padding */
                cursor: pointer; /* Pointer/hand icon */
                float: none; /* Float the buttons side by side */
                margin: 5px;
                height: 62px;

            }

            /* Clear floats (clearfix hack) */
            .btn-group:after {
                content: "";
                clear: both;
                display: table;
            }

            .btn-group button:not(:last-child) {
                border-right: none; /* Prevent double borders */
            }

            /* Add a background color on hover */
            .btn-group button:hover {
                background-color: #3e8e41;
            }
                        /* Add a background color on hover */
            .btn-group button:disabled {
                background-color: grey;
            }

            .alarm-well{
                width: 100%;
                height: 500px;
                background-color: #eb8080;
                border: 1px solid darkgrey;
                float: none;
                margin: 0;
                font-size: x-large;
                text-align: left;
            }            
            .banner-well{
                width: 100%;
                height: 75px;
                border: 1px solid darkgrey;
                float: none;
                margin: 20px 15px 20px 15px;
                text-align: center;
                font-size: xx-large;
                color: white;
            }
            ul{
                font-size: x-large;
                list-style-type: none;
            }
        </style>
        <link href="@Resources.Root/Shared/Content/bootstrap.css" rel="stylesheet">
        <script src="@Resources.Root/Shared/Scripts/jquery.js"></script>
        <script src="@Resources.Root/Shared/Scripts/bootstrap.js"></script>
        <script src="@Resources.Root/Shared/Scripts/jquery.signalR.js"></script>
        <script src="@Resources.Root/Shared/Scripts/gsf.web.client.js"></script>
        <script src="signalr/hubs"></script>

        <script src="Scripts/Site.js"></script>
    </head>
    <body>
        <div class="banner-well" style="background-color: @view.Color">
            @view.Name - @view.State 
        </div>
        <div class="col-md-6">
            <h2>Device Stats</h2>
            <ul>
                <li>Device Name: @view.Name</li>
                <li>Make: SEL</li>
                <li>Model: SEL-421</li>
                <li>Substation: S1234 Davidson</li>
                <li>Location Desc: Switch house</li>
                <li>Lat:</li>
                <li>Long:</li>
                <li>Area: North</li>
                <li>TSC: Murfreesboro</li>
                <li>Resp. Engineer: Reggie White</li>
                <li>Line(s) Monitored:
                    <ol>
                        <li>L1234 161 Cumberland FP - Davidson</li>
                        <li>L4321 161 Cumberland FP - Kentucky</li>
                    </ol>
                </li>
                <li>Analog channels: 16</li>
                <li>Digital channels: 8</li>
            </ul>
        </div>
        <div class="col-md-6" style="text-align:center">
            <div class="alarm-well">
                Channel 11, PHA-V, Exceeded out-of-engineering reasonable limit of -1.0E14 volts for 120 minutes.
                <br /> 
                Other alarms, if present, for CUF-PMU have been suppressed.
            </div>
            <div class="btn-group" style="width:100%">
                <button style="width:75%" disabled>Acknowledge Alarm</button>
                <button style="width:33.3%" disabled>Clear &amp; Reconnect</button>
                <button style="width:33.3%" onclick="SetInService()" disabled>Reset to Normal (Clear)</button>
                <button style="width:33.3%" onclick="SetOutOfService()" disabled>Set to Out-of-Service</button>
                <button style="width:33.3%" disabled>Reconnect</button>
                <button style="width:33.3%" onclick="SetInService()" disabled>Clear Out-of-Service</button>
                <button style="width:33.3%" disabled>Park Alarm</button>
                <button style="width:33.3%" disabled>Alarm Log</button>
                <button style="width:33.3%" disabled>Device Data</button>
                <button style="width:33.3%" disabled>TBD</button>
                <button style="width:33.3%" disabled>Performance Data</button>
            </div>

        </div>

        <script>
            var id = @view.ID;

            $(window).on("hubConnected", function () {
                $('button').removeAttr('disabled')
            });

            function SetInService() {
                dataHub.setInService(id).done(function () {
                    location.reload()
                });
            }

            function SetOutOfService() {
                dataHub.setOutOfService(id).done(function () {
                    location.reload()
                });
            }
        </script>
    </body>

</html>
